import{c as k,a as N,r as i,j as e,B as c,f as v}from"./index-B1TKH03G.js";import{u as w,P as A}from"./PostCard-DmCHqHbX.js";import{C as F,d as M}from"./card-yrt95q4Q.js";import{D as T,a as B,b as E,c as Q}from"./ShareModal-CNKdFKbW.js";import{I as j}from"./input-CCyB3kA2.js";import{I as C}from"./image-DKlu83bo.js";import{X as $}from"./x-ChRXEarc.js";import{P as L}from"./plus-IwLfdX6i.js";import"./dropdown-menu-l-4mx64D.js";import"./en-US-Bnkcyeeb.js";import"./send-De83bHxe.js";import"./heart-C0FwWlPt.js";import"./share-2-BHjpIwdU.js";import"./check-D4-FbOjS.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=k("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=k("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),q=({isOpen:g,onClose:x})=>{const{addPost:h}=w(),{user:t}=N(),[n,a]=i.useState("post"),[m,u]=i.useState(""),[o,b]=i.useState(""),[p,f]=i.useState(""),[l,y]=i.useState(["",""]),S=()=>{l.length<5&&y([...l,""])},O=(r,s)=>{const d=[...l];d[r]=s,y(d)},I=r=>{if(l.length>2){const s=l.filter((d,D)=>D!==r);y(s)}},z=()=>{if(t){if(n==="poll"){if(!p.trim()||l.some(s=>!s.trim()))return;const r=l.map((s,d)=>({id:`opt-${d}`,label:s,votes:0}));h({type:"poll",content:p,poll:{id:`poll-${Date.now()}`,question:p,options:r,totalVotes:0},author:t,authorId:t.id})}else{if(!m.trim())return;h({type:o?"image":"text",content:m,imageUrl:o||void 0,author:t,authorId:t.id})}u(""),b(""),f(""),y(["",""]),x()}},U=n==="poll"?p.trim()&&l.every(r=>r.trim()):m.trim();return e.jsx(T,{open:g,onOpenChange:r=>!r&&x(),children:e.jsxs(B,{className:"max-w-xl",children:[e.jsx(E,{children:e.jsx(Q,{children:"Cr√©er une publication"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-2 mb-4 border-b border-gray-100 dark:border-gray-700 pb-2",children:[e.jsxs(c,{variant:"ghost",onClick:()=>a("post"),className:v("flex-1 gap-2 rounded-lg",n==="post"?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-bold":"text-gray-500 dark:text-gray-400"),children:[e.jsx(C,{className:"h-4 w-4"}),"Publication"]}),e.jsxs(c,{variant:"ghost",onClick:()=>a("poll"),className:v("flex-1 gap-2 rounded-lg",n==="poll"?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-bold":"text-gray-500 dark:text-gray-400"),children:[e.jsx(P,{className:"h-4 w-4"}),"Sondage"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex-shrink-0 overflow-hidden border border-gray-100 dark:border-gray-700",children:t!=null&&t.avatarUrl?e.jsx("img",{src:t.avatarUrl,className:"h-full w-full object-cover"}):null}),e.jsx("div",{className:"flex-1 space-y-3",children:n==="post"?e.jsxs(e.Fragment,{children:[e.jsx("textarea",{value:m,onChange:r=>u(r.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 dark:text-gray-100 border border-gray-200 dark:border-gray-600 rounded-xl p-3 text-sm focus:ring-2 focus:ring-blue-100 dark:focus:ring-blue-900/40 focus:border-blue-300 dark:focus:border-blue-600 transition-all resize-none font-medium",placeholder:`Quoi de neuf, ${t==null?void 0:t.firstName} ?`,rows:4}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{value:o,onChange:r=>b(r.target.value),placeholder:"URL de l'image (optionnel)...",className:"text-xs bg-gray-50 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600"}),o&&e.jsx("div",{className:"h-32 w-full bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:e.jsx("img",{src:o,className:"h-full w-full object-cover",onError:r=>r.currentTarget.style.display="none"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("textarea",{value:p,onChange:r=>f(r.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 dark:text-gray-100 border border-gray-200 dark:border-gray-600 rounded-xl p-3 text-sm focus:ring-2 focus:ring-blue-100 dark:focus:ring-blue-900/40 focus:border-blue-300 dark:focus:border-blue-600 transition-all resize-none font-bold text-lg placeholder:font-normal",placeholder:"Posez votre question...",rows:2}),e.jsxs("div",{className:"space-y-2",children:[l.map((r,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{value:r,onChange:d=>O(s,d.target.value),placeholder:`Option ${s+1}`,className:"bg-gray-50 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 text-sm"}),l.length>2&&e.jsx("button",{onClick:()=>I(s),className:"text-gray-400 dark:text-gray-500 hover:text-red-500",children:e.jsx($,{className:"h-4 w-4"})})]},s)),l.length<5&&e.jsxs(c,{variant:"ghost",size:"sm",onClick:S,className:"text-blue-600 text-xs gap-1 h-8 pl-1",children:[e.jsx(L,{className:"h-3 w-3"}),"Ajouter une option"]})]})]})})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx(c,{onClick:z,disabled:!U,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-full px-6 shadow-md shadow-blue-200 disabled:opacity-50",children:"Publier"})})]})]})]})})},se=()=>{const{filter:g,setFilter:x,getFilteredPosts:h,fetchPosts:t,isLoading:n}=w(),{user:a}=N(),[m,u]=i.useState(!1),o=h(a==null?void 0:a.department);return i.useEffect(()=>{t(a==null?void 0:a.id)},[t,a==null?void 0:a.id]),n?e.jsx("div",{className:"text-center py-10",children:"Chargement des publications..."}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 pb-10",children:[e.jsxs(F,{className:"shadow-sm border-gray-200 dark:border-gray-700 overflow-hidden cursor-pointer hover:shadow-md transition-all",onClick:()=>u(!0),children:[e.jsxs(M,{className:"p-4 flex gap-3 items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-50 dark:bg-blue-900/30 border border-blue-100 dark:border-blue-800 flex items-center justify-center font-bold text-blue-600 dark:text-blue-400 flex-shrink-0 overflow-hidden",children:a!=null&&a.avatarUrl?e.jsx("img",{src:a.avatarUrl,className:"h-full w-full object-cover"}):a==null?void 0:a.firstName[0]}),e.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-gray-700 rounded-full px-4 py-2.5 text-sm text-gray-500 dark:text-gray-400 font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors text-left",children:["Quoi de neuf, ",a==null?void 0:a.firstName," ? Commencez une publication..."]})]}),e.jsx("div",{className:"px-4 py-3 border-t dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4 ml-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 text-xs font-semibold hover:bg-gray-100 dark:hover:bg-gray-700 px-2 py-1 rounded-md transition-colors",children:[e.jsx(C,{className:"h-4 w-4 text-blue-500"}),"Photo"]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 text-xs font-semibold hover:bg-gray-100 dark:hover:bg-gray-700 px-2 py-1 rounded-md transition-colors",children:[e.jsx(P,{className:"h-4 w-4 text-green-500"}),"Sondage"]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs font-semibold hover:bg-gray-100 px-2 py-1 rounded-md transition-colors",children:[e.jsx(R,{className:"h-4 w-4 text-yellow-500"}),"Humeur"]})]})})]}),e.jsx(q,{isOpen:m,onClose:()=>u(!1)}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsx(c,{variant:g==="all"?"default":"outline",size:"sm",onClick:()=>x("all"),className:"rounded-full px-4 font-semibold shadow-sm",children:"Tous"}),e.jsx(c,{variant:g==="popular"?"default":"outline",size:"sm",onClick:()=>x("popular"),className:"rounded-full px-4 font-semibold shadow-sm",children:"Populaires üî•"}),(a==null?void 0:a.department)&&e.jsxs(c,{variant:g==="department"?"default":"outline",size:"sm",onClick:()=>x("department"),className:"rounded-full px-4 font-semibold shadow-sm",children:["Mon D√©partement (",a.department,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[o.map(b=>e.jsx(A,{post:b},b.id)),o.length===0&&e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucune publication trouv√©e pour ce filtre."})})]})]})};export{se as FeedPage};
