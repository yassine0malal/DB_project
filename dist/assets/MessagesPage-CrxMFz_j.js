import{c as X,e as Z,b as ee,a as E,j as s,f as M,r as p,B as N,m as te}from"./index-B1TKH03G.js";import{t as b,c as v,a as H,d as re,f as A,g as C,e as ae}from"./en-US-Bnkcyeeb.js";import{a as O,s as F,f as z}from"./fr-C6hzHdjj.js";import{I as ne}from"./input-CCyB3kA2.js";import{V as se}from"./video-Dvf87XYw.js";import{M as ie,S as L}from"./send-De83bHxe.js";import{I as ce}from"./image-DKlu83bo.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=X("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=X("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);function D(r){return O(r,{weekStartsOn:1})}function $(r){const e=b(r),t=e.getFullYear(),a=v(r,0);a.setFullYear(t+1,0,4),a.setHours(0,0,0,0);const n=D(a),i=v(r,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const l=D(i);return e.getTime()>=n.getTime()?t+1:e.getTime()>=l.getTime()?t:t-1}function ue(r,e){const t=F(r),a=F(e),n=+t-H(t),i=+a-H(a);return Math.round((n-i)/re)}function le(r){const e=$(r),t=v(r,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),D(t)}function fe(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function me(r){if(!fe(r)&&typeof r!="number")return!1;const e=b(r);return!isNaN(Number(e))}function he(r){const e=b(r),t=v(r,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function ge(r){const e=b(r);return ue(e,he(e))+1}function xe(r){const e=b(r),t=+D(e)-+le(e);return Math.round(t/A)+1}function V(r,e){var d,u,g,y;const t=b(r),a=t.getFullYear(),n=C(),i=(e==null?void 0:e.firstWeekContainsDate)??((u=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((y=(g=n.locale)==null?void 0:g.options)==null?void 0:y.firstWeekContainsDate)??1,l=v(r,0);l.setFullYear(a+1,0,i),l.setHours(0,0,0,0);const c=O(l,e),f=v(r,0);f.setFullYear(a,0,i),f.setHours(0,0,0,0);const x=O(f,e);return t.getTime()>=c.getTime()?a+1:t.getTime()>=x.getTime()?a:a-1}function we(r,e){var c,f,x,d;const t=C(),a=(e==null?void 0:e.firstWeekContainsDate)??((f=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((d=(x=t.locale)==null?void 0:x.options)==null?void 0:d.firstWeekContainsDate)??1,n=V(r,e),i=v(r,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),O(i,e)}function be(r,e){const t=b(r),a=+O(t,e)-+we(t,e);return Math.round(a/A)+1}function o(r,e){const t=r<0?"-":"",a=Math.abs(r).toString().padStart(e,"0");return t+a}const w={y(r,e){const t=r.getFullYear(),a=t>0?t:1-t;return o(e==="yy"?a%100:a,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):o(t+1,2)},d(r,e){return o(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return o(r.getHours()%12||12,e.length)},H(r,e){return o(r.getHours(),e.length)},m(r,e){return o(r.getMinutes(),e.length)},s(r,e){return o(r.getSeconds(),e.length)},S(r,e){const t=e.length,a=r.getMilliseconds(),n=Math.trunc(a*Math.pow(10,t-3));return o(n,e.length)}},j={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},R={G:function(r,e,t){const a=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(a,{width:"abbreviated"});case"GGGGG":return t.era(a,{width:"narrow"});case"GGGG":default:return t.era(a,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const a=r.getFullYear(),n=a>0?a:1-a;return t.ordinalNumber(n,{unit:"year"})}return w.y(r,e)},Y:function(r,e,t,a){const n=V(r,a),i=n>0?n:1-n;if(e==="YY"){const l=i%100;return o(l,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):o(i,e.length)},R:function(r,e){const t=$(r);return o(t,e.length)},u:function(r,e){const t=r.getFullYear();return o(t,e.length)},Q:function(r,e,t){const a=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(a);case"QQ":return o(a,2);case"Qo":return t.ordinalNumber(a,{unit:"quarter"});case"QQQ":return t.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(a,{width:"wide",context:"formatting"})}},q:function(r,e,t){const a=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(a);case"qq":return o(a,2);case"qo":return t.ordinalNumber(a,{unit:"quarter"});case"qqq":return t.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(a,{width:"wide",context:"standalone"})}},M:function(r,e,t){const a=r.getMonth();switch(e){case"M":case"MM":return w.M(r,e);case"Mo":return t.ordinalNumber(a+1,{unit:"month"});case"MMM":return t.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(a,{width:"wide",context:"formatting"})}},L:function(r,e,t){const a=r.getMonth();switch(e){case"L":return String(a+1);case"LL":return o(a+1,2);case"Lo":return t.ordinalNumber(a+1,{unit:"month"});case"LLL":return t.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(a,{width:"wide",context:"standalone"})}},w:function(r,e,t,a){const n=be(r,a);return e==="wo"?t.ordinalNumber(n,{unit:"week"}):o(n,e.length)},I:function(r,e,t){const a=xe(r);return e==="Io"?t.ordinalNumber(a,{unit:"week"}):o(a,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):w.d(r,e)},D:function(r,e,t){const a=ge(r);return e==="Do"?t.ordinalNumber(a,{unit:"dayOfYear"}):o(a,e.length)},E:function(r,e,t){const a=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(a,{width:"short",context:"formatting"});case"EEEE":default:return t.day(a,{width:"wide",context:"formatting"})}},e:function(r,e,t,a){const n=r.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return o(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(r,e,t,a){const n=r.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return o(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(r,e,t){const a=r.getDay(),n=a===0?7:a;switch(e){case"i":return String(n);case"ii":return o(n,e.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(a,{width:"short",context:"formatting"});case"iiii":default:return t.day(a,{width:"wide",context:"formatting"})}},a:function(r,e,t){const n=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(r,e,t){const a=r.getHours();let n;switch(a===12?n=j.noon:a===0?n=j.midnight:n=a/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(r,e,t){const a=r.getHours();let n;switch(a>=17?n=j.evening:a>=12?n=j.afternoon:a>=4?n=j.morning:n=j.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let a=r.getHours()%12;return a===0&&(a=12),t.ordinalNumber(a,{unit:"hour"})}return w.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):w.H(r,e)},K:function(r,e,t){const a=r.getHours()%12;return e==="Ko"?t.ordinalNumber(a,{unit:"hour"}):o(a,e.length)},k:function(r,e,t){let a=r.getHours();return a===0&&(a=24),e==="ko"?t.ordinalNumber(a,{unit:"hour"}):o(a,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):w.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):w.s(r,e)},S:function(r,e){return w.S(r,e)},X:function(r,e,t){const a=r.getTimezoneOffset();if(a===0)return"Z";switch(e){case"X":return G(a);case"XXXX":case"XX":return k(a);case"XXXXX":case"XXX":default:return k(a,":")}},x:function(r,e,t){const a=r.getTimezoneOffset();switch(e){case"x":return G(a);case"xxxx":case"xx":return k(a);case"xxxxx":case"xxx":default:return k(a,":")}},O:function(r,e,t){const a=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+B(a,":");case"OOOO":default:return"GMT"+k(a,":")}},z:function(r,e,t){const a=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+B(a,":");case"zzzz":default:return"GMT"+k(a,":")}},t:function(r,e,t){const a=Math.trunc(r.getTime()/1e3);return o(a,e.length)},T:function(r,e,t){const a=r.getTime();return o(a,e.length)}};function B(r,e=""){const t=r>0?"-":"+",a=Math.abs(r),n=Math.trunc(a/60),i=a%60;return i===0?t+String(n):t+String(n)+e+o(i,2)}function G(r,e){return r%60===0?(r>0?"-":"+")+o(Math.abs(r)/60,2):k(r,e)}function k(r,e=""){const t=r>0?"-":"+",a=Math.abs(r),n=o(Math.trunc(a/60),2),i=o(a%60,2);return t+n+e+i}const Q=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},K=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},ye=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],a=t[1],n=t[2];if(!n)return Q(r,e);let i;switch(a){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Q(a,e)).replace("{{time}}",K(n,e))},ke={p:K,P:ye},ve=/^D+$/,Ne=/^Y+$/,je=["D","DD","YY","YYYY"];function Oe(r){return ve.test(r)}function pe(r){return Ne.test(r)}function Me(r,e,t){const a=De(r,e,t);if(console.warn(a),je.includes(r))throw new RangeError(a)}function De(r,e,t){const a=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${a} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ye=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Se=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Te=/^'([^]*?)'?$/,Ee=/''/g,Ce=/[a-zA-Z]/;function U(r,e,t){var d,u,g,y,W,P,q,I;const a=C(),n=(t==null?void 0:t.locale)??a.locale??ae,i=(t==null?void 0:t.firstWeekContainsDate)??((u=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??a.firstWeekContainsDate??((y=(g=a.locale)==null?void 0:g.options)==null?void 0:y.firstWeekContainsDate)??1,l=(t==null?void 0:t.weekStartsOn)??((P=(W=t==null?void 0:t.locale)==null?void 0:W.options)==null?void 0:P.weekStartsOn)??a.weekStartsOn??((I=(q=a.locale)==null?void 0:q.options)==null?void 0:I.weekStartsOn)??0,c=b(r);if(!me(c))throw new RangeError("Invalid time value");let f=e.match(Se).map(h=>{const m=h[0];if(m==="p"||m==="P"){const Y=ke[m];return Y(h,n.formatLong)}return h}).join("").match(Ye).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const m=h[0];if(m==="'")return{isToken:!1,value:We(h)};if(R[m])return{isToken:!0,value:h};if(m.match(Ce))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:h}});n.localize.preprocessor&&(f=n.localize.preprocessor(c,f));const x={firstWeekContainsDate:i,weekStartsOn:l,locale:n};return f.map(h=>{if(!h.isToken)return h.value;const m=h.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&pe(m)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&Oe(m))&&Me(m,e,String(r));const Y=R[m[0]];return Y(c,m,n.localize,x)}).join("")}function We(r){const e=r.match(Te);return e?e[1].replace(Ee,"'"):r}const J=ee,S=Z,T=[{id:"m1",senderId:S.id,content:"Bonjour ! Avez-vous des questions sur le projet de base de données ?",timestamp:new Date(Date.now()-36e5).toISOString(),isRead:!0,type:"text"},{id:"m2",senderId:J.id,content:"Oui, je me demandais comment implémenter les relations Many-to-Many.",timestamp:new Date(Date.now()-18e5).toISOString(),isRead:!0,type:"text"},{id:"m3",senderId:S.id,content:"C'est une excellente question. Il faut utiliser une table de jointure.",timestamp:new Date(Date.now()-6e5).toISOString(),isRead:!1,type:"text"}],_=[{id:"c1",participants:[J,S],lastMessage:T[2],unreadCount:1,updatedAt:T[2].timestamp}],Pe=({conversations:r,activeConversationId:e,onConversationSelect:t})=>{const{user:a}=E();return s.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-gray-900 border-r dark:border-gray-800",children:[s.jsx("div",{className:"p-4 border-b dark:border-gray-800",children:s.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Messages"})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?s.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400 text-sm",children:"Aucune conversation"}):r.map(n=>{var c;const i=n.participants.find(f=>f.id!==(a==null?void 0:a.id)),l=e===n.id;return s.jsxs("button",{onClick:()=>t(n.id),className:M("w-full flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-b border-gray-50 dark:border-gray-800 text-left",l&&"bg-blue-50/50 dark:bg-blue-900/10"),children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 overflow-hidden flex-shrink-0",children:i!=null&&i.avatarUrl?s.jsx("img",{src:i.avatarUrl,className:"h-full w-full object-cover"}):s.jsx("div",{className:"h-full w-full flex items-center justify-center text-blue-600 font-bold",children:i==null?void 0:i.firstName[0]})}),n.unreadCount>0&&s.jsx("div",{className:"absolute -top-1 -right-1 h-5 w-5 bg-blue-600 text-white text-[10px] font-bold rounded-full flex items-center justify-center border-2 border-white",children:n.unreadCount})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:[i==null?void 0:i.firstName," ",i==null?void 0:i.lastName]}),s.jsx("span",{className:"text-[10px] text-gray-400 capitalize",children:n.lastMessage&&U(new Date(n.lastMessage.timestamp),"HH:mm",{locale:z})})]}),s.jsx("p",{className:M("text-sm truncate",n.unreadCount>0?"text-gray-900 dark:text-gray-100 font-bold":"text-gray-500 dark:text-gray-400"),children:((c=n.lastMessage)==null?void 0:c.content)||"Dites bonjour !"})]})]},n.id)})})]})},qe=({conversation:r,messages:e,onSendMessage:t})=>{const{user:a}=E(),[n,i]=p.useState(""),l=p.useRef(null),c=r.participants.find(d=>d.id!==(a==null?void 0:a.id)),f=()=>{var d;(d=l.current)==null||d.scrollIntoView({behavior:"smooth"})};p.useEffect(()=>{f()},[e]);const x=d=>{d.preventDefault(),n.trim()&&(t(n),i(""))};return s.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-gray-900/50",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-900 p-4 border-b dark:border-gray-800 flex items-center justify-between shadow-sm z-10 text-gray-900 dark:text-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 overflow-hidden",children:c!=null&&c.avatarUrl?s.jsx("img",{src:c.avatarUrl,className:"h-full w-full object-cover"}):s.jsx("div",{className:"h-full w-full flex items-center justify-center text-blue-600 font-bold",children:c==null?void 0:c.firstName[0]})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-gray-900 dark:text-gray-100",children:[c==null?void 0:c.firstName," ",c==null?void 0:c.lastName]}),s.jsx("p",{className:"text-xs text-green-500 font-medium",children:"En ligne"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(N,{variant:"ghost",size:"icon",className:"text-gray-400",children:s.jsx(de,{className:"h-4 w-4"})}),s.jsx(N,{variant:"ghost",size:"icon",className:"text-gray-400",children:s.jsx(se,{className:"h-4 w-4"})}),s.jsx(N,{variant:"ghost",size:"icon",className:"text-gray-400",children:s.jsx(ie,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.length===0?s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-8",children:[s.jsx("div",{className:"h-20 w-20 bg-blue-50 dark:bg-blue-900/10 rounded-full flex items-center justify-center mb-4",children:s.jsx(L,{className:"h-10 w-10 text-blue-200 dark:text-blue-800"})}),s.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100",children:"Démarrer une conversation"}),s.jsxs("p",{className:"text-sm text-gray-500 max-w-[200px]",children:["Envoyez un message pour commencer à discuter avec ",c==null?void 0:c.firstName,"."]})]}):e.map((d,u)=>{const g=d.senderId===(a==null?void 0:a.id),y=u===e.length-1||new Date(e[u+1].timestamp).getTime()-new Date(d.timestamp).getTime()>3e5;return s.jsxs("div",{className:M("flex flex-col",g?"items-end":"items-start"),children:[s.jsx("div",{className:M("max-w-[70%] px-4 py-2 rounded-2xl text-sm shadow-sm",g?"bg-blue-600 text-white rounded-tr-none":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-tl-none border border-gray-100 dark:border-gray-700"),children:d.content}),y&&s.jsx("span",{className:"text-[10px] text-gray-400 mt-1 px-1",children:U(new Date(d.timestamp),"HH:mm",{locale:z})})]},d.id)}),s.jsx("div",{ref:l})]}),s.jsx("div",{className:"bg-white dark:bg-gray-900 p-4 border-t dark:border-gray-800",children:s.jsxs("form",{onSubmit:x,className:"flex gap-2",children:[s.jsx(N,{type:"button",variant:"ghost",size:"icon",className:"text-gray-400 dark:text-gray-500 shrink-0",children:s.jsx(oe,{className:"h-5 w-5"})}),s.jsx(N,{type:"button",variant:"ghost",size:"icon",className:"text-gray-400 shrink-0",children:s.jsx(ce,{className:"h-5 w-5"})}),s.jsx(ne,{value:n,onChange:d=>i(d.target.value),placeholder:"Écrivez votre message...",className:"flex-1 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:ring-blue-100 dark:focus:ring-blue-900 dark:text-gray-100 dark:placeholder:text-gray-500"}),s.jsx(N,{type:"submit",disabled:!n.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white shrink-0",children:s.jsx(L,{className:"h-4 w-4"})})]})})]})},Qe=()=>{const{conversations:r,activeConversationId:e,messages:t,setConversations:a,setActiveConversation:n,addMessage:i,markAsRead:l}=te(),{user:c}=E();p.useEffect(()=>{r.length===0&&(a(_),_.forEach(u=>{t[u.id]||T.forEach(g=>i(u.id,g))}))},[]);const f=u=>{if(!e||!c)return;const g={id:Date.now().toString(),senderId:c.id,content:u,timestamp:new Date().toISOString(),isRead:!0,type:"text"};i(e,g)},x=u=>{n(u),l(u)},d=r.find(u=>u.id===e);return s.jsxs("div",{className:"h-[calc(100vh-100px)] flex bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-sm border border-gray-100 dark:border-gray-800",children:[s.jsx("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-gray-900 border-r dark:border-gray-800",children:s.jsx(Pe,{conversations:r,activeConversationId:e,onConversationSelect:x})}),s.jsx("div",{className:"flex-1 border-l",children:d?s.jsx(qe,{conversation:d,messages:t[d.id]||[],onSendMessage:f}):s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 p-8 space-y-4 bg-gray-50 dark:bg-gray-800/50",children:[s.jsx("div",{className:"h-24 w-24 bg-gray-50 dark:bg-gray-800 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-12 h-12 text-gray-200 dark:text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-100 mb-1",children:"Sélectionnez une conversation"}),s.jsx("p",{className:"text-sm max-w-[250px]",children:"Choisissez une conversation dans la liste pour commencer à discuter."})]})]})})]})};export{Qe as MessagesPage};
