import{c as y,j as e,L as p,g as R,u as P,a as D,r as h,U as j,B as o,S as H,M as k,C as T,H as q}from"./index-B1TKH03G.js";import{u as z,m as B,L as E,T as N}from"./useGroupStore-Dcy9XBOP.js";import{S as $}from"./shield-ClSyZ9el.js";import{A as F}from"./arrow-left-Dq8d_76k.js";import{G as V}from"./globe-CY08mSIG.js";import{S as Y}from"./share-2-BHjpIwdU.js";import{M as J}from"./more-horizontal-Djog7VHv.js";import{G}from"./graduation-cap-CM-s4NDS.js";import{H as O}from"./heart-C0FwWlPt.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=y("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=y("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=y("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),W=d=>{switch(d){case"admin":return{label:"Admin",icon:f,color:"text-amber-600 bg-amber-50"};case"moderator":return{label:"Mod√©rateur",icon:$,color:"text-blue-600 bg-blue-50"};default:return{label:"Membre",icon:K,color:"text-gray-600 bg-gray-50"}}},C=({members:d,compact:u=!1})=>{const t=[...d].sort((s,l)=>{const a={admin:0,moderator:1,member:2};return a[s.role]-a[l.role]});if(u){const s=t.slice(0,5),l=t.length-5;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex -space-x-2",children:s.map(a=>e.jsx("img",{src:a.user.avatarUrl||`https://ui-avatars.com/api/?name=${a.user.firstName}+${a.user.lastName}&background=random`,alt:`${a.user.firstName} ${a.user.lastName}`,className:"h-8 w-8 rounded-full border-2 border-white object-cover",title:`${a.user.firstName} ${a.user.lastName}`},a.user.id))}),l>0&&e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["+",l," autres"]})]})}return e.jsx("div",{className:"space-y-2",children:t.map(s=>{const l=W(s.role),a=l.icon;return e.jsxs(p,{to:`/profile/${s.user.id}`,className:"flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 transition-colors",children:[e.jsx("img",{src:s.user.avatarUrl||`https://ui-avatars.com/api/?name=${s.user.firstName}+${s.user.lastName}&background=random`,alt:`${s.user.firstName} ${s.user.lastName}`,className:"h-12 w-12 rounded-full object-cover ring-2 ring-gray-100"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium text-gray-900 truncate",children:[s.user.firstName," ",s.user.lastName]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:"major"in s.user&&s.user.major?s.user.major:s.user.email})]}),e.jsxs("span",{className:`flex items-center gap-1 text-xs font-medium px-2.5 py-1 rounded-full ${l.color}`,children:[e.jsx(a,{className:"h-3 w-3"}),l.label]})]},s.user.id)})})},X=d=>{switch(d){case"friends":return{label:"Groupe d'amis",icon:O,color:"bg-pink-100 text-pink-700"};case"apartment":return{label:"Colocation",icon:q,color:"bg-amber-100 text-amber-700"};case"class":return{label:"Promotion",icon:G,color:"bg-blue-100 text-blue-700"};case"club":return{label:"Sous-groupe club",icon:N,color:"bg-purple-100 text-purple-700"};default:return{label:"Groupe",icon:j,color:"bg-gray-100 text-gray-700"}}},de=()=>{var w;const{id:d}=R(),u=P(),{user:t}=D(),{activeGroup:s,setActiveGroup:l,groups:a,setGroups:v,joinGroup:M,leaveGroup:I}=z(),[m,S]=h.useState("feed");if(h.useEffect(()=>{a.length===0&&v(B)},[a.length,v]),h.useEffect(()=>{const r=a.find(i=>i.id===d);return r&&l(r),()=>l(null)},[d,a,l]),!s)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Chargement du groupe..."})]});const b=X(s.type),A=b.icon,n=t&&s.members.some(r=>r.user.id===t.id),g=t&&s.members.some(r=>r.user.id===t.id&&r.role==="admin"),c=t&&((w=s.members.find(r=>r.user.id===t.id))==null?void 0:w.role),L=()=>{t&&(n?I(s.id,t.id):M(s.id,t))},U=[{key:"feed",label:"Publications",icon:k},{key:"members",label:"Membres",icon:j},{key:"about",label:"√Ä propos",icon:Q}];return e.jsxs("div",{className:"max-w-5xl mx-auto pb-10",children:[e.jsxs("button",{onClick:()=>u("/groups"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[e.jsx(F,{className:"h-4 w-4"}),"Retour aux groupes"]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"h-48 md:h-64 relative",children:[e.jsx("img",{src:s.coverUrl||"https://images.unsplash.com/photo-1522071820081-009f0129c71c?auto=format&fit=crop&q=80&w=1200&h=400",alt:s.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent"}),e.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[e.jsxs("span",{className:`text-sm px-3 py-1.5 rounded-full flex items-center gap-1.5 font-medium ${b.color}`,children:[e.jsx(A,{className:"h-4 w-4"}),b.label]}),s.visibility==="private"?e.jsxs("span",{className:"bg-gray-900/70 text-white text-sm px-3 py-1.5 rounded-full flex items-center gap-1.5",children:[e.jsx(E,{className:"h-4 w-4"})," Priv√©"]}):e.jsxs("span",{className:"bg-green-600/80 text-white text-sm px-3 py-1.5 rounded-full flex items-center gap-1.5",children:[e.jsx(V,{className:"h-4 w-4"})," Public"]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-white/90",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4"}),s.members.length," membre",s.members.length>1?"s":""]}),s.type==="club"&&s.parentClubName&&e.jsxs(p,{to:`/clubs/${s.parentClubId}`,className:"hover:underline",children:["‚Üê ",s.parentClubName]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 dark:border-gray-700 flex flex-wrap items-center justify-between gap-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(C,{members:s.members.slice(0,5),compact:!0})}),e.jsxs("div",{className:"flex items-center gap-2",children:[c&&e.jsxs("span",{className:`flex items-center gap-1 text-sm font-medium px-3 py-1.5 rounded-full ${c==="admin"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400":c==="moderator"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[c==="admin"&&e.jsx(f,{className:"h-4 w-4"}),c==="moderator"&&e.jsx($,{className:"h-4 w-4"}),c==="admin"?"Admin":c==="moderator"?"Mod√©rateur":"Membre"]}),!g&&e.jsx(o,{variant:n?"outline":"default",onClick:L,className:n?"hover:text-red-600 hover:border-red-300":"bg-blue-600 hover:bg-blue-700",children:n?"Quitter le groupe":"Rejoindre"}),g&&e.jsxs(o,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"G√©rer"]}),e.jsx(o,{variant:"ghost",size:"icon",children:e.jsx(Y,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"px-6 border-b border-gray-100 dark:border-gray-700",children:e.jsx("div",{className:"flex gap-1",children:U.map(({key:r,label:i,icon:x})=>e.jsxs("button",{onClick:()=>S(r),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m===r?"border-blue-600 text-blue-600 dark:text-blue-400 dark:border-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[e.jsx(x,{className:"h-4 w-4"}),i]},r))})})]}),e.jsxs("div",{className:"mt-6",children:[m==="feed"&&e.jsx("div",{className:"space-y-4",children:s.posts.length>0?s.posts.map(r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("img",{src:r.author.avatarUrl||`https://ui-avatars.com/api/?name=${r.author.firstName}+${r.author.lastName}&background=random`,alt:`${r.author.firstName} ${r.author.lastName}`,className:"h-10 w-10 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:[r.author.firstName," ",r.author.lastName]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(r.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(J,{className:"h-4 w-4 text-gray-500"})})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:r.content}),r.imageUrl&&e.jsx("img",{src:r.imageUrl,alt:"Post",className:"mt-3 rounded-lg w-full max-h-96 object-cover"}),r.poll&&e.jsxs("div",{className:"mt-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-3",children:r.poll.question}),e.jsx("div",{className:"space-y-2",children:r.poll.options.map(i=>{const x=Math.round(i.votes/r.poll.totalVotes*100);return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-100 rounded-lg",style:{width:`${x}%`}}),e.jsxs("div",{className:"relative flex items-center justify-between p-2 rounded-lg border border-gray-200 bg-white/50",children:[e.jsx("span",{children:i.label}),e.jsxs("span",{className:"text-sm font-medium",children:[x,"%"]})]})]},i.id)})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[r.poll.totalVotes," votes"]})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-4 pt-3 border-t border-gray-100 text-sm text-gray-500",children:[e.jsxs("span",{children:["‚ù§Ô∏è ",r.likesCount]}),e.jsxs("span",{children:["üí¨ ",r.commentsCount]}),r.sharesCount>0&&e.jsxs("span",{children:["üîÑ ",r.sharesCount]})]})]},r.id)):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-dashed border-gray-200",children:[e.jsx(k,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Aucune publication pour le moment."}),n&&e.jsx(o,{className:"mt-4 bg-blue-600 hover:bg-blue-700",children:"Cr√©er une publication"})]})}),m==="members"&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[s.members.length," membre",s.members.length>1?"s":""]}),g&&e.jsx(o,{variant:"outline",size:"sm",children:"Inviter des membres"})]}),e.jsx(C,{members:s.members})]}),m==="about"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Description"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:s.description})]}),s.type==="class"&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 p-6 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),"Informations acad√©miques"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.level&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Niveau"}),e.jsx("p",{className:"font-medium text-blue-900",children:s.level})]}),s.major&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Fili√®re"}),e.jsx("p",{className:"font-medium text-blue-900",children:s.major})]}),s.academicYear&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Ann√©e acad√©mique"}),e.jsx("p",{className:"font-medium text-blue-900",children:s.academicYear})]})]})]}),s.type==="club"&&s.parentClubName&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5 text-purple-600"}),"Club parent"]}),e.jsxs(p,{to:`/clubs/${s.parentClubId}`,className:"flex items-center gap-3 p-3 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors",children:[e.jsx("div",{className:"p-2 bg-purple-200 rounded-lg",children:e.jsx(N,{className:"h-5 w-5 text-purple-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-purple-900",children:s.parentClubName}),e.jsx("p",{className:"text-sm text-purple-600",children:"Voir le club ‚Üí"})]})]})]}),s.rules&&s.rules.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"R√®gles du groupe"}),e.jsx("ul",{className:"space-y-2",children:s.rules.map((r,i)=>e.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[e.jsx("span",{className:"bg-gray-200 text-gray-700 text-xs font-medium px-2 py-0.5 rounded-full mt-0.5",children:i+1}),r]},i))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Informations"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(T,{className:"h-4 w-4"}),"Cr√©√© le ",new Date(s.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(f,{className:"h-4 w-4"}),"Cr√©√© par ",s.createdBy.firstName," ",s.createdBy.lastName]})]})]})]})]})]})};export{de as GroupDetailsPage};
