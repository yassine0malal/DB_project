import{h as b}from"./index-B1TKH03G.js";import{d as c}from"./ShareModal-CNKdFKbW.js";const d=b((a,n)=>({clubs:[],activeClub:null,filters:{category:"all",search:""},isLoading:!1,error:null,setClubs:r=>a({clubs:r}),setActiveClub:r=>a({activeClub:r}),fetchClubs:async r=>{try{const{clubs:e}=await c.getClubs(r);a({clubs:e})}catch(e){console.error(e)}},fetchClubDetails:async(r,e)=>{try{const t=await c.getClub(r,e);a({activeClub:t})}catch(t){console.error(t)}},createClub:r=>{a(e=>({clubs:[r,...e.clubs]}))},joinClub:async(r,e)=>{a(t=>{var l;const i=t.clubs.map(o=>{if(o.id===r){if((o.members||[]).some(u=>u.user.id===e.id))return o;const m={user:e,role:"member",joinedAt:new Date().toISOString()};return{...o,members:[...o.members||[],m],membersCount:(o.membersCount||0)+1,isMember:!0}}return o}),s=((l=t.activeClub)==null?void 0:l.id)===r?{...t.activeClub,members:[...t.activeClub.members||[],{user:e,role:"member",joinedAt:new Date().toISOString()}],membersCount:(t.activeClub.membersCount||0)+1,isMember:!0}:t.activeClub;return{clubs:i,activeClub:s}}),await c.joinClub(r,e.id)},leaveClub:async(r,e)=>{a(t=>{var l;const i=t.clubs.map(o=>o.id===r?{...o,members:(o.members||[]).filter(m=>m.user.id!==e),membersCount:Math.max(0,(o.membersCount||0)-1),isMember:!1}:o),s=((l=t.activeClub)==null?void 0:l.id)===r?{...t.activeClub,members:(t.activeClub.members||[]).filter(o=>o.user.id!==e),membersCount:Math.max(0,(t.activeClub.membersCount||0)-1),isMember:!1}:t.activeClub;return{clubs:i,activeClub:s}}),await c.leaveClub(r,e)},addEvent:(r,e)=>{console.log("Add event local",r,e)},toggleParticipation:(r,e)=>{console.log("Toggle participation local",r,e)},setFilter:(r,e)=>a(t=>({filters:{...t.filters,[r]:e}})),getFilteredClubs:()=>{const{clubs:r,filters:e}=n();return r.filter(t=>{const i=e.category==="all"||t.category===e.category,s=t.name.toLowerCase().includes(e.search.toLowerCase())||t.description.toLowerCase().includes(e.search.toLowerCase());return i&&s})}}));export{d as u};
